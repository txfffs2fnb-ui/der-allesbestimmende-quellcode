<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Everything Code - Institutional v9.5</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #f1f5f9; margin: 0; overflow-x: hidden; }
        .glass-card { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .gradient-text { background: linear-gradient(90deg, #38bdf8, #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .tab-active { border-bottom: 2px solid #38bdf8; color: #38bdf8; font-weight: 700; }
        .node rect { fill-opacity: 0.9; shape-rendering: crispEdges; stroke-width: 0; }
        .node text { pointer-events: none; font-size: 9px; font-weight: 900; fill: #94a3b8; text-transform: uppercase; letter-spacing: 0.05em; }
        .link { fill: none; stroke-opacity: 0.15; transition: stroke-opacity 0.3s; }
        .link:hover { stroke-opacity: 0.6; }
        .chart-label { font-size: 10px; font-weight: 700; fill: #64748b; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <header class="mb-10 flex flex-col md:flex-row justify-between items-start md:items-center border-b border-slate-800 pb-8">
            <div>
                <h1 class="text-4xl font-extrabold gradient-text italic tracking-tighter">Everything Code</h1>
                <p class="text-slate-400 mt-1 text-sm font-bold uppercase tracking-widest">Global Liquidity & Macro Cycle Framework</p>
            </div>
            <div class="mt-6 md:mt-0 flex flex-col items-end text-right">
                <span class="px-4 py-1 bg-sky-500/10 text-sky-400 rounded-full text-[10px] font-black border border-sky-500/20 uppercase tracking-widest">Institutional Edition v9.5</span>
                <p class="text-[9px] text-slate-500 mt-2 uppercase tracking-widest font-bold">Raoul Pal Framework Integration</p>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav class="flex gap-8 mb-8 border-b border-slate-800">
            <button onclick="switchTab('argument')" id="tab-argument" class="pb-4 px-2 text-sm uppercase tracking-widest font-bold tab-active transition-all">Geldflüsse & Argumentationskette</button>
            <button onclick="switchTab('macro')" id="tab-macro" class="pb-4 px-2 text-sm uppercase tracking-widest font-bold text-slate-500 hover:text-slate-300 transition-all">Makrolage Dashboard</button>
        </nav>

        <!-- Tab 1: Argument Chain & Flows -->
        <div id="content-argument">
            <section class="mb-12">
                <div class="flex items-center gap-4 mb-8">
                    <div class="h-px flex-1 bg-slate-800"></div>
                    <h2 class="text-xs font-black uppercase tracking-[0.4em] text-slate-500">The Raoul Pal Argument Chain</h2>
                    <div class="h-px flex-1 bg-slate-800"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="glass-card p-6 rounded-3xl">
                        <div class="text-[10px] font-black text-sky-500 uppercase mb-4 tracking-widest">Step 01: Die Schuldenfalle</div>
                        <h3 class="text-lg font-extrabold text-slate-200 mb-2 italic">Interest Expense Squeeze</h3>
                        <p class="text-[11px] text-slate-400 leading-relaxed">Staaten können ihre Zinslast nicht mehr aus Steuern decken. Die einzige Lösung ist neue Verschuldung zur Begleichung alter Schulden.</p>
                    </div>
                    <div class="glass-card p-6 rounded-3xl">
                        <div class="text-[10px] font-black text-indigo-500 uppercase mb-4 tracking-widest">Step 02: Notenbank-Zwang</div>
                        <h3 class="text-lg font-extrabold text-slate-200 mb-2 italic">Monetary Debasement</h3>
                        <p class="text-[11px] text-slate-400 leading-relaxed">Um den Kollaps des Anleihenmarktes zu verhindern, müssen Zentralbanken Liquidität bereitstellen. Die Währung wird entwertet.</p>
                    </div>
                    <div class="glass-card p-6 rounded-3xl border-sky-500/30">
                        <div class="text-[10px] font-black text-sky-400 uppercase mb-4 tracking-widest">Step 03: Asset Inflation</div>
                        <h3 class="text-lg font-extrabold text-slate-200 mb-2 italic">Hard Asset Revaluation</h3>
                        <p class="text-[11px] text-slate-400 leading-relaxed">Knappe Güter (Tech-Aktien, Krypto, Gold) steigen im Preis, da mehr Währungseinheiten auf dieselbe Menge an Assets treffen.</p>
                    </div>
                    <div class="glass-card p-6 rounded-3xl">
                        <div class="text-[10px] font-black text-purple-500 uppercase mb-4 tracking-widest">Step 04: Der Outcome</div>
                        <h3 class="text-lg font-extrabold text-slate-200 mb-2 italic">The Everything Code</h3>
                        <p class="text-[11px] text-slate-400 leading-relaxed">Wohlstand wird nicht durch Cash, sondern durch Asset-Besitz bewahrt. Der Zyklus ist mathematisch determiniert.</p>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <div class="glass-card p-8 rounded-[40px] overflow-hidden">
                    <div class="mb-8 flex justify-between items-end">
                        <div>
                            <h2 class="text-2xl font-black italic tracking-tighter">Globale Liquiditätsströme</h2>
                            <p class="text-slate-500 text-[10px] uppercase font-bold tracking-widest mt-1">Sankey Modellierung: Debt Creation to Asset Allocation</p>
                        </div>
                    </div>
                    <div id="sankey-chart" class="w-full h-[600px]"></div>
                </div>
            </section>
        </div>

        <!-- Tab 2: Macro Dashboard -->
        <div id="content-macro" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Chart 1: Demographics vs Debt -->
                <div class="glass-card p-8 rounded-[40px]">
                    <h3 class="text-xl font-black italic mb-2">1. Demografie & Schulden</h3>
                    <p class="text-slate-500 text-[10px] uppercase font-bold tracking-widest mb-6">Arbeitskräfte-Rückgang vs. Schulden-Wachstum (USA)</p>
                    <div id="chart-demographics" class="h-[300px] w-full"></div>
                    <p class="text-[11px] text-slate-400 mt-4 italic">Theorie: Sinkende Produktivität durch Alterung zwingt Staaten zu höherer Verschuldung, um das System am Laufen zu halten.</p>
                </div>

                <!-- Chart 2: The Banana Zone (Liquidity) -->
                <div class="glass-card p-8 rounded-[40px]">
                    <h3 class="text-xl font-black italic mb-2">2. Die "Banana Zone"</h3>
                    <p class="text-slate-500 text-[10px] uppercase font-bold tracking-widest mb-6">Netto-Liquidität vs. S&P 500 & Krypto</p>
                    <div id="chart-liquidity" class="h-[300px] w-full"></div>
                    <p class="text-[11px] text-slate-400 mt-4 italic">Beobachtung: Assets explodieren parabolisch ("Banana Shape"), wenn die globale Liquidität ihren zyklischen Wendepunkt erreicht.</p>
                </div>

                <!-- Chart 3: The Maturity Wall -->
                <div class="glass-card p-8 rounded-[40px] lg:col-span-2">
                    <h3 class="text-xl font-black italic mb-2">3. The Maturity Wall</h3>
                    <p class="text-slate-500 text-[10px] uppercase font-bold tracking-widest mb-6">Anstehende Umschuldungen (Mrd. USD)</p>
                    <div id="chart-maturity" class="h-[250px] w-full"></div>
                    <p class="text-[11px] text-slate-400 mt-4 italic">Gefahr: Ein Großteil der globalen Schulden muss zwischen 2024 und 2026 zu potenziell höheren Zinsen refinanziert werden, was mehr Liquiditätsspritzen erfordert.</p>
                </div>
            </div>
        </div>

        <footer class="mt-20 border-t border-slate-800 pt-8 pb-12 text-center">
            <p class="text-[10px] text-slate-600 font-bold uppercase tracking-[0.5em]">Global Macro Framework • 2024 • Raoul Pal Thesis Integration</p>
        </footer>
    </div>

    <script>
        function switchTab(tab) {
            document.getElementById('content-argument').classList.add('hidden');
            document.getElementById('content-macro').classList.add('hidden');
            document.getElementById('tab-argument').classList.remove('tab-active', 'text-slate-500');
            document.getElementById('tab-macro').classList.remove('tab-active', 'text-slate-500');

            if(tab === 'argument') {
                document.getElementById('content-argument').classList.remove('hidden');
                document.getElementById('tab-argument').classList.add('tab-active');
                document.getElementById('tab-macro').classList.add('text-slate-500');
                renderSankey();
            } else {
                document.getElementById('content-macro').classList.remove('hidden');
                document.getElementById('tab-macro').classList.add('tab-active');
                document.getElementById('tab-argument').classList.add('text-slate-500');
                renderMacroCharts();
            }
        }

        function renderSankey() {
            const container = document.getElementById('sankey-chart');
            container.innerHTML = '';
            const width = container.offsetWidth;
            const height = container.offsetHeight;

            const svg = d3.select("#sankey-chart").append("svg")
                .attr("width", width)
                .attr("height", height);

            const sankey = d3.sankey()
                .nodeWidth(14)
                .nodePadding(30)
                .extent([[1, 1], [width - 1, height - 6]]);

            const data = {
                nodes: [
                    { name: "Debt Issuance (Global)" }, // 0
                    { name: "US FED Liquidity" },      // 1
                    { name: "PBOC (China) Stimulus" },  // 2
                    { name: "ECB (Europe) Flows" },     // 3
                    { name: "BOJ (Japan) Support" },    // 4
                    { name: "Global M2 Supply" },       // 5
                    { name: "Technology Stocks" },      // 6
                    { name: "Crypto / Digital Gold" },  // 7
                    { name: "Real Estate & Commodities" }, // 8
                    { name: "Global Wealth" }           // 9
                ],
                links: [
                    { source: 0, target: 1, value: 35 },
                    { source: 0, target: 2, value: 25 },
                    { source: 0, target: 3, value: 15 },
                    { source: 0, target: 4, value: 10 },
                    { source: 1, target: 5, value: 30 },
                    { source: 2, target: 5, value: 20 },
                    { source: 3, target: 5, value: 12 },
                    { source: 4, target: 5, value: 8 },
                    { source: 5, target: 6, value: 35 },
                    { source: 5, target: 7, value: 15 },
                    { source: 5, target: 8, value: 20 },
                    { source: 6, target: 9, value: 35 },
                    { source: 7, target: 9, value: 15 },
                    { source: 8, target: 9, value: 20 }
                ]
            };

            const graph = sankey(data);
            const colors = ["#38bdf8", "#818cf8", "#c084fc", "#fb7185", "#34d399", "#fbbf24"];

            svg.append("g")
                .selectAll(".link")
                .data(graph.links)
                .enter().append("path")
                .attr("class", "link")
                .attr("d", d3.sankeyLinkHorizontal())
                .attr("stroke", (d, i) => colors[d.source.index % colors.length])
                .attr("stroke-width", d => Math.max(1, d.width))
                .append("title")
                .text(d => `${d.source.name} → ${d.target.name}
${d.value}T USD`);

            const node = svg.append("g")
                .selectAll(".node")
                .data(graph.nodes)
                .enter().append("g")
                .attr("class", "node")
                .attr("transform", d => `translate(${d.x0},${d.y0})`);

            node.append("rect")
                .attr("height", d => d.y1 - d.y0)
                .attr("width", sankey.nodeWidth())
                .style("fill", (d, i) => colors[i % colors.length]);

            node.append("text")
                .attr("x", -10)
                .attr("y", d => (d.y1 - d.y0) / 2)
                .attr("dy", ".35em")
                .attr("text-anchor", "end")
                .text(d => d.name)
                .filter(d => d.x0 < width / 2)
                .attr("x", 10 + sankey.nodeWidth())
                .attr("text-anchor", "start");
        }

        function renderMacroCharts() {
            const margin = {top: 20, right: 30, bottom: 40, left: 40};

            // Chart 1: Demographics vs Debt
            (function() {
                const container = document.getElementById('chart-demographics');
                container.innerHTML = '';
                const w = container.offsetWidth, h = container.offsetHeight;
                const svg = d3.select("#chart-demographics").append("svg").attr("width", w).attr("height", h);
                const x = d3.scaleLinear().domain([2000, 2040]).range([margin.left, w - margin.right]);
                const y = d3.scaleLinear().domain([0, 180]).range([h - margin.bottom, margin.top]);

                const debt = [[2000, 56], [2010, 95], [2020, 128], [2030, 150], [2040, 175]];
                const labor = [[2000, 150], [2010, 140], [2020, 125], [2030, 110], [2040, 95]];

                const line = d3.line().x(d => x(d[0])).y(d => y(d[1])).curve(d3.curveBasis);
                svg.append("path").datum(debt).attr("fill", "none").attr("stroke", "#38bdf8").attr("stroke-width", 3).attr("d", line);
                svg.append("path").datum(labor).attr("fill", "none").attr("stroke", "#f43f5e").attr("stroke-width", 3).attr("d", line);
                
                svg.append("text").attr("x", x(2035)).attr("y", y(165)).attr("class", "chart-label").text("DEBT/GDP").attr("fill", "#38bdf8");
                svg.append("text").attr("x", x(2035)).attr("y", y(90)).attr("class", "chart-label").text("WORKING POP").attr("fill", "#f43f5e");
            })();

            // Chart 2: Banana Zone
            (function() {
                const container = document.getElementById('chart-liquidity');
                container.innerHTML = '';
                const w = container.offsetWidth, h = container.offsetHeight;
                const svg = d3.select("#chart-liquidity").append("svg").attr("width", w).attr("height", h);
                const x = d3.scaleLinear().domain([0, 10]).range([margin.left, w - margin.right]);
                const y = d3.scaleLinear().domain([0, 100]).range([h - margin.bottom, margin.top]);

                const liqData = [[0, 10], [2, 12], [4, 15], [6, 40], [8, 85], [10, 95]];
                const area = d3.area().x(d => x(d[0])).y0(h - margin.bottom).y1(d => y(d[1])).curve(d3.curveBasis);
                
                svg.append("path").datum(liqData).attr("fill", "url(#grad)").attr("opacity", 0.4).attr("d", area);
                
                const defs = svg.append("defs");
                const grad = defs.append("linearGradient").attr("id", "grad").attr("x1", "0%").attr("y1", "100%").attr("x2", "0%").attr("y2", "0%");
                grad.append("stop").attr("offset", "0%").attr("stop-color", "#38bdf8").attr("stop-opacity", 0);
                grad.append("stop").attr("offset", "100%").attr("stop-color", "#fbbf24").attr("stop-opacity", 0.8);

                svg.append("text").attr("x", x(7)).attr("y", y(60)).attr("class", "chart-label").text("BANANA ZONE").attr("fill", "#fbbf24").style("font-size", "14px");
            })();

            // Chart 3: Maturity Wall
            (function() {
                const container = document.getElementById('chart-maturity');
                container.innerHTML = '';
                const w = container.offsetWidth, h = container.offsetHeight;
                const svg = d3.select("#chart-maturity").append("svg").attr("width", w).attr("height", h);
                const data = [
                    {year: '2024', val: 7.2}, {year: '2025', val: 8.5}, {year: '2026', val: 9.1},
                    {year: '2027', val: 6.4}, {year: '2028', val: 5.8}, {year: '2029', val: 4.2}
                ];
                const x = d3.scaleBand().domain(data.map(d => d.year)).range([margin.left, w - margin.right]).padding(0.3);
                const y = d3.scaleLinear().domain([0, 10]).range([h - margin.bottom, margin.top]);

                svg.selectAll("rect").data(data).enter().append("rect")
                    .attr("x", d => x(d.year)).attr("y", d => y(d.val))
                    .attr("width", x.bandwidth()).attr("height", d => h - margin.bottom - y(d.val))
                    .attr("fill", d => d.year <= '2026' ? "#f43f5e" : "#38bdf8")
                    .attr("rx", 4);
                
                svg.selectAll(".year-label").data(data).enter().append("text")
                    .attr("x", d => x(d.year) + x.bandwidth()/2).attr("y", h - margin.bottom + 15)
                    .attr("text-anchor", "middle").attr("class", "chart-label").text(d => d.year);
            })();
        }

        renderSankey();
        window.addEventListener('resize', () => { 
            if(!document.getElementById('content-argument').classList.contains('hidden')) renderSankey();
            else renderMacroCharts();
        });
    </script>
</body>
</html>
